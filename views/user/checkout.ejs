<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%=title%>
    </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/MaterialDesign-Webfont/5.3.45/css/materialdesignicons.css"
        integrity="sha256-NAxhqDvtY0l4xn+YVa6WjAcmd94NNfttjNsDmNatFVc=" crossorigin="anonymous" />
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <style>
        body {
            margin-top: 20px;
            background-color: #f1f3f7;
        }

        .card {
            margin-bottom: 24px;
            -webkit-box-shadow: 0 2px 3px #e4e8f0;
            box-shadow: 0 2px 3px #e4e8f0;
        }

        .card {
            position: relative;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-orient: vertical;
            -webkit-box-direction: normal;
            -ms-flex-direction: column;
            flex-direction: column;
            min-width: 0;
            word-wrap: break-word;
            background-color: #fff;
            background-clip: border-box;
            border: 1px solid #eff0f2;
            border-radius: 1rem;
        }

        .activity-checkout {
            list-style: none
        }

        .activity-checkout .checkout-icon {
            position: absolute;
            top: -4px;
            left: -24px
        }

        .activity-checkout .checkout-item {
            position: relative;
            padding-bottom: 24px;
            padding-left: 35px;
            border-left: 2px solid #f5f6f8
        }

        .activity-checkout .checkout-item:first-child {
            border-color: #3b76e1
        }

        .activity-checkout .checkout-item:first-child:after {
            background-color: #3b76e1
        }

        .activity-checkout .checkout-item:last-child {
            border-color: transparent
        }

        .activity-checkout .checkout-item.crypto-activity {
            margin-left: 50px
        }

        .activity-checkout .checkout-item .crypto-date {
            position: absolute;
            top: 3px;
            left: -65px
        }



        .avatar-xs {
            height: 1rem;
            width: 1rem
        }

        .avatar-sm {
            height: 2rem;
            width: 2rem
        }

        .avatar {
            height: 3rem;
            width: 3rem
        }

        .avatar-md {
            height: 4rem;
            width: 4rem
        }

        .avatar-lg {
            height: 5rem;
            width: 5rem
        }

        .avatar-xl {
            height: 6rem;
            width: 6rem
        }

        .avatar-title {
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
            background-color: #3b76e1;
            color: #fff;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            font-weight: 500;
            height: 100%;
            -webkit-box-pack: center;
            -ms-flex-pack: center;
            justify-content: center;
            width: 100%
        }

        .avatar-group {
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            padding-left: 8px
        }

        .avatar-group .avatar-group-item {
            margin-left: -8px;
            border: 2px solid #fff;
            border-radius: 50%;
            -webkit-transition: all .2s;
            transition: all .2s
        }

        .avatar-group .avatar-group-item:hover {
            position: relative;
            -webkit-transform: translateY(-2px);
            transform: translateY(-2px)
        }

        .card-radio {
            background-color: #fff;
            border: 2px solid #eff0f2;
            border-radius: .75rem;
            padding: .5rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            display: block
        }

        .card-radio:hover {
            cursor: pointer
        }

        .card-radio-label {
            display: block
        }

        .edit-btn {
            width: 35px;
            height: 35px;
            line-height: 40px;
            text-align: center;
            position: absolute;
            right: 25px;
            margin-top: -50px
        }

        .card-radio-input {
            display: none
        }

        .card-radio-input:checked+.card-radio {
            border-color: #3b76e1 !important
        }


        .font-size-16 {
            font-size: 16px !important;
        }

        .text-truncate {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        a {
            text-decoration: none !important;
        }


        .form-control {
            display: block;
            width: 100%;
            padding: 0.47rem 0.75rem;
            font-size: .875rem;
            font-weight: 400;
            line-height: 1.5;
            color: #545965;
            background-color: #fff;
            background-clip: padding-box;
            border: 1px solid #e2e5e8;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            border-radius: 0.75rem;
            -webkit-transition: border-color .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;
            transition: border-color .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;
            transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;
            transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out, -webkit-box-shadow .15s ease-in-out;
        }

        .edit-btn {
            width: 35px;
            height: 35px;
            line-height: 40px;
            text-align: center;
            position: absolute;
            right: 25px;
            margin-top: -50px;
        }

        .ribbon {
            position: absolute;
            right: -26px;
            top: 20px;
            -webkit-transform: rotate(45deg);
            transform: rotate(45deg);
            color: #fff;
            font-size: 13px;
            font-weight: 500;
            padding: 1px 22px;
            font-size: 13px;
            font-weight: 500
        }
    </style>
</head>

<body>
    <div class="container">
        <% if (message && message.length> 0) { %>
            <div class="flash-message alert alert-danger ">
                <%= message %>
            </div>
            <% } %>
                <form id="checkoutForm" action="/cart/checkout/process" method="POST">
                    <% if (typeof orderId !=='undefined' ) { %>
                        <input type="hidden" name="orderId" value="<%= orderId %>">
                        <% } %>

                            <div class="row">
                                <div class="col-xl-8">
                                    <div class="card">
                                        <div class="card-body">
                                            <ol class="activity-checkout mb-0 px-4 mt-3">
                                                <li class="checkout-item">
                                                    <div class="avatar checkout-icon p-1">
                                                        <div class="avatar-title rounded-circle bg-primary">
                                                            <i class="bx bxs-receipt text-white font-size-20"></i>
                                                        </div>
                                                    </div>
                                                    <div class="feed-item-list">
                                                        <div>
                                                            <h5 class="font-size-16 mb-1">Billing Info</h5>
                                                            <p class="text-muted text-truncate mb-4">Account Details</p>
                                                            <div class="mb-3">
                                                                <form>
                                                                    <div>
                                                                        <div class="row">
                                                                            <div class="col-lg-4">
                                                                                <div class="mb-3">
                                                                                    <label class="form-label"
                                                                                        for="billing-name">Name</label>
                                                                                    <input type="text"
                                                                                        class="form-control"
                                                                                        id="billing-name"
                                                                                        value="<%= user.name %>"
                                                                                        placeholder="Enter name"
                                                                                        readonly>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-lg-4">
                                                                                <div class="mb-3">
                                                                                    <label class="form-label"
                                                                                        for="billing-email-address">Email
                                                                                        Address</label>
                                                                                    <input type="email"
                                                                                        class="form-control"
                                                                                        id="billing-email-address"
                                                                                        value="<%= user.email %>"
                                                                                        placeholder="Enter email"
                                                                                        readonly>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-lg-4">
                                                                                <div class="mb-3">
                                                                                    <label class="form-label"
                                                                                        for="billing-phone">Phone</label>
                                                                                    <input type="text"
                                                                                        class="form-control"
                                                                                        id="billing-phone"
                                                                                        value=" <%= user.phone %>"
                                                                                        placeholder="Enter Phone no."
                                                                                        readonly>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </form>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </li>
                                                <li class="checkout-item">
                                                    <div class="avatar checkout-icon p-1">
                                                        <div class="avatar-title rounded-circle bg-primary">
                                                            <i class="bx bxs-truck text-white font-size-20"></i>
                                                        </div>
                                                    </div>
                                                    <div class="feed-item-list">
                                                        <div>
                                                            <h5 class="font-size-16 mb-1">Shipping Info</h5>
                                                            <p class="text-muted text-truncate mb-4">Address</p>
                                                            <% const homeAddresses=addresses.filter(address=>
                                                                address.type ===
                                                                'Home');
                                                                %>
                                                                <% if (homeAddresses.length> 0) { %>
                                                                    <% homeAddresses.forEach(function(address) { %>
                                                                        <div class="mb-3">
                                                                            <div class="row">
                                                                                <div class="col-lg-4 col-sm-6">
                                                                                    <div data-bs-toggle="collapse">
                                                                                        <label
                                                                                            class="card-radio-label mb-0">
                                                                                            <input type="radio"
                                                                                                name="addressId"
                                                                                                id="info-address1"
                                                                                                class="card-radio-input"
                                                                                                checked=""
                                                                                                value="<%= address._id %>">
                                                                                            <div
                                                                                                class="card-radio text-truncate p-3">
                                                                                                <span
                                                                                                    class="fs-14 mb-4 d-block">
                                                                                                    <%= address.type %>:
                                                                                                </span>
                                                                                                <span
                                                                                                    class="fs-14 mb-2 d-block">
                                                                                                    <%= user.name %>
                                                                                                </span>
                                                                                                <span
                                                                                                    class="text-muted fw-normal text-wrap mb-1 d-block">
                                                                                                    <%= address.street
                                                                                                        %>, <%=
                                                                                                            address.city
                                                                                                            %>, <%=
                                                                                                                address.state
                                                                                                                %>
                                                                                                                , <%=
                                                                                                                    address.postalCode
                                                                                                                    %>
                                                                                                </span>
                                                                                                <span
                                                                                                    class="text-muted fw-normal d-block">Mob:
                                                                                                    <%= user.phone %>
                                                                                                </span>
                                                                                            </div>
                                                                                        </label>
                                                                                        <% }); %>
                                                                                            <% } else { %>

                                                                                                <div class="mb-3">
                                                                                                    <div class="row">
                                                                                                        <div
                                                                                                            class="col-lg-4 col-sm-6">
                                                                                                            <div
                                                                                                                data-bs-toggle="collapse">
                                                                                                                <label
                                                                                                                    class="card-radio-label mb-0">
                                                                                                                    <input
                                                                                                                        type="radio"
                                                                                                                        name="address"
                                                                                                                        id="info-address1"
                                                                                                                        class="card-radio-input"
                                                                                                                        checked="">
                                                                                                                    <div
                                                                                                                        class="card-radio text-truncate p-3">
                                                                                                                        <span
                                                                                                                            class="fs-14 mb-4 d-block">

                                                                                                                        </span>
                                                                                                                        <span
                                                                                                                            class="fs-14 mb-2 d-block">
                                                                                                                            <%= user.name
                                                                                                                                %>
                                                                                                                        </span>
                                                                                                                        <span
                                                                                                                            class="text-muted fw-normal text-wrap mb-1 d-block">
                                                                                                                            no
                                                                                                                            house
                                                                                                                            address
                                                                                                                            found
                                                                                                                        </span>

                                                                                                                        <span
                                                                                                                            class="text-muted fw-normal d-block">Mob:
                                                                                                                            <%= user.phone
                                                                                                                                %>
                                                                                                                        </span>
                                                                                                                    </div>
                                                                                                                </label>

                                                                                                                <% } %>

                                                                                                                    <div
                                                                                                                        class="edit-btn bg-light  rounded">
                                                                                                                        <a href="/cart/checkout/edit"
                                                                                                                            data-bs-toggle="tooltip"
                                                                                                                            data-placement="top"
                                                                                                                            title=""
                                                                                                                            data-bs-original-title="Edit">
                                                                                                                            <i
                                                                                                                                class="bx bx-pencil font-size-16"></i>
                                                                                                                        </a>
                                                                                                                    </div>
                                                                                                            </div>
                                                                                                        </div>

                                                                                                        <% const
                                                                                                            officeAddresses=addresses.filter(address=>
                                                                                                            address.type
                                                                                                            ===
                                                                                                            'Office');
                                                                                                            %>
                                                                                                            <% if
                                                                                                                (officeAddresses.length>
                                                                                                                0) { %>
                                                                                                                <% officeAddresses.forEach(function(address)
                                                                                                                    { %>
                                                                                                                    <div
                                                                                                                        class="col-lg-4 col-sm-6">
                                                                                                                        <div>
                                                                                                                            <label
                                                                                                                                class="card-radio-label mb-0">
                                                                                                                                <input
                                                                                                                                    type="radio"
                                                                                                                                    name="addressId"
                                                                                                                                    id="info-address2"
                                                                                                                                    value="<%= address._id %>"
                                                                                                                                    class="card-radio-input">
                                                                                                                                <div
                                                                                                                                    class="card-radio text-truncate p-3">
                                                                                                                                    <span
                                                                                                                                        class="fs-14 mb-4 d-block">
                                                                                                                                        <%= address.type
                                                                                                                                            %>
                                                                                                                                            :
                                                                                                                                    </span>
                                                                                                                                    <span
                                                                                                                                        class="fs-14 mb-2 d-block">
                                                                                                                                        <%= user.name
                                                                                                                                            %>
                                                                                                                                    </span>
                                                                                                                                    <span
                                                                                                                                        class="text-muted fw-normal text-wrap mb-1 d-block">

                                                                                                                                        <%= address.street
                                                                                                                                            %>
                                                                                                                                            ,
                                                                                                                                            <%= address.city
                                                                                                                                                %>
                                                                                                                                                ,
                                                                                                                                                <%= address.state
                                                                                                                                                    %>
                                                                                                                                                    ,
                                                                                                                                                    <%= address.postalCode
                                                                                                                                                        %>
                                                                                                                                    </span>
                                                                                                                                    <span
                                                                                                                                        class="text-muted fw-normal d-block">Mob:
                                                                                                                                        <%=
                                                                                                                                            user.phone%>
                                                                                                                                    </span>
                                                                                                                                </div>
                                                                                                                            </label>

                                                                                                                            <% });
                                                                                                                                %>
                                                                                                                                <% } else
                                                                                                                                    {
                                                                                                                                    %>
                                                                                                                                    <div
                                                                                                                                        class="col-lg-4 col-sm-6">
                                                                                                                                        <div>
                                                                                                                                            <label
                                                                                                                                                class="card-radio-label mb-0">
                                                                                                                                                <input
                                                                                                                                                    type="radio"
                                                                                                                                                    name="address"
                                                                                                                                                    id="info-address2"
                                                                                                                                                    class="card-radio-input">
                                                                                                                                                <div
                                                                                                                                                    class="card-radio text-truncate p-3">
                                                                                                                                                    <span
                                                                                                                                                        class="fs-14 mb-4 d-block">

                                                                                                                                                    </span>
                                                                                                                                                    <span
                                                                                                                                                        class="fs-14 mb-2 d-block">
                                                                                                                                                        <%= user.name
                                                                                                                                                            %>
                                                                                                                                                    </span>
                                                                                                                                                    <span
                                                                                                                                                        class="text-muted fw-normal text-wrap mb-1 d-block">

                                                                                                                                                        no
                                                                                                                                                        office
                                                                                                                                                        address
                                                                                                                                                        found
                                                                                                                                                    </span>
                                                                                                                                                    <span
                                                                                                                                                        class="text-muted fw-normal d-block">Mob:
                                                                                                                                                        <%=
                                                                                                                                                            user.phone%>
                                                                                                                                                    </span>
                                                                                                                                                </div>
                                                                                                                                            </label>

                                                                                                                                            <% }
                                                                                                                                                %>
                                                                                                                                                <div
                                                                                                                                                    class="edit-btn bg-light  rounded">
                                                                                                                                                    <a href="/cart/checkout/edit"
                                                                                                                                                        data-bs-toggle="tooltip"
                                                                                                                                                        data-placement="top"
                                                                                                                                                        title=""
                                                                                                                                                        data-bs-original-title="Edit">
                                                                                                                                                        <i
                                                                                                                                                            class="bx bx-pencil font-size-16"></i>
                                                                                                                                                    </a>
                                                                                                                                                </div>
                                                                                                                                        </div>
                                                                                                                                    </div>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                    </div>
                                                                                                </div>
                                                </li>
                                                <li class="checkout-item">
                                                    <div class="avatar checkout-icon p-1">
                                                        <div class="avatar-title rounded-circle bg-primary">
                                                            <i class="bx bxs-wallet-alt text-white font-size-20"></i>
                                                        </div>
                                                    </div>
                                                    <div class="feed-item-list">
                                                        <div>
                                                            <h5 class="font-size-16 mb-1">Payment Info</h5>
                                                            <p class="text-muted text-truncate mb-4">Select one</p>
                                                        </div>
                                                        <div>
                                                            <h5 class="font-size-14 mb-3">Payment method :</h5>
                                                            <div class="row">
                                                                <div class="col-lg-3 col-sm-6">
                                                                    <div data-bs-toggle="collapse">
                                                                        <label class="card-radio-label">
                                                                            <input type="radio" name="payMethod"
                                                                                id="pay-methodoption1"
                                                                                class="card-radio-input">
                                                                            <span
                                                                                class="card-radio py-3 text-center text-truncate">
                                                                                <i
                                                                                    class="bx bx-credit-card d-block h2 mb-3"></i>
                                                                                other
                                                                            </span>
                                                                        </label>
                                                                    </div>
                                                                </div>

                                                                <div class="col-lg-3 col-sm-6">
                                                                    <div>
                                                                        <label class="card-radio-label">
                                                                            <input type="radio" name="payMethod"
                                                                                id="pay-methodoption2"
                                                                                class="card-radio-input"
                                                                                value="Razorpay">
                                                                            <span
                                                                                class="card-radio py-3 text-center text-truncate">
                                                                                <i
                                                                                    class="bx bxl-paypal d-block h2 mb-3"></i>
                                                                                Razor Pay
                                                                            </span>
                                                                        </label>
                                                                    </div>
                                                                </div>

                                                                <div class="col-lg-3 col-sm-6">
                                                                    <div>
                                                                        <label class="card-radio-label">
                                                                            <input type="radio" name="payMethod"
                                                                                id="pay-methodoption3"
                                                                                class="card-radio-input"
                                                                                value="Cash On Delivery" checked="">

                                                                            <span
                                                                                class="card-radio py-3 text-center text-truncate">
                                                                                <i
                                                                                    class="bx bx-money d-block h2 mb-3"></i>
                                                                                <span>Cash On Delivery</span>
                                                                            </span>
                                                                        </label>
                                                                    </div>
                                                                </div>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </li>
                                            </ol>
                                        </div>
                                    </div>
                </form>

                <div class="row my-4">
                    <div class="col">
                        <a href="/cart" class="btn btn-link text-muted">
                            <i class="mdi mdi-arrow-left me-1"></i> Back to cart </a>
                    </div> <!-- end col -->
                    <div class="col">
                        <div class="text-end mt-2 mt-sm-0">
                            <!-- Add the hidden input field for total amount -->
                            <input type="hidden" name="totalAmount" value="<%= totalAmount %>">
                            <button type="submit" class="btn btn-success">
                                <i class="mdi mdi-cart-outline me-1"></i> Place the oder </button>

                            </form>
                        </div>
                    </div> <!-- end col -->
                </div> <!-- end row-->
    </div>
    <div class="col-xl-4">
        <div class="card checkout-order-summary">
            <div class="card-body">
                <div class="p-3 bg-light mb-3">
                    <h5 class="font-size-16 mb-0">Order Summary <span class="float-end ms-2"></span></h5>
                </div>
                <% if (cart && cart.items) { %>
                    <% cart.items.forEach(item=> { %>

                        <div class="table-responsive">
                            <table class="table table-centered mb-0 table-nowrap">
                                <thead>
                                    <tr>
                                        <th class="border-top-0" style="width: 110px;" scope="col">Product</th>
                                        <th class="border-top-0" scope="col">Product Desc</th>
                                        <th class="border-top-0" scope="col">Price</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th scope="row"><img
                                                src="<%= item.product.images.length > 0 ? item.product.images[0].url : '/placeholder-image.jpg' %>"
                                                alt="<%=item.product.name %>" title="product-img"
                                                class="avatar-lg rounded"></th>
                                        <td>
                                            <h5 class="font-size-16 text-truncate"><a href="#" class="text-dark">
                                                    <%= item.product.name %>
                                                </a></h5>
                                            <p class="text-muted mb-0">
                                                <i class="bx bxs-star text-warning"></i>
                                                <i class="bx bxs-star text-warning"></i>
                                                <i class="bx bxs-star text-warning"></i>
                                                <i class="bx bxs-star text-warning"></i>
                                                <i class="bx bxs-star-half text-warning"></i>
                                            </p>
                                            <p class="text-muted mb-0 mt-1">
                                                <%= item.quantity %>*<%=item.product.price %>
                                            </p>
                                        </td>
                                        <td>₹:<%= item.quantity *item.product.price %>
                                        </td>
                                    </tr>
                                    <% }); %>
                                        <% } else { %>
                                            <p>No items in the cart</p>
                                            <% } %>


                                                <tr class="bg-light">
                                                    <td colspan="2">
                                                        <h5 class="font-size-14 m-0">Total Amount To Pay:</h5>
                                                    </td>
                                                    <td>
                                                        ₹ <%= totalAmount.toFixed(2) %>
                                                    </td>
                                                </tr>
                                </tbody>
                            </table>

                        </div>
            </div>
        </div>
    </div>
    </div>
    <!-- end row -->

    </div>



    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
        // Function to handle Razorpay payment initiation
        function initiateRazorpayPayment(orderId, totalAmount, prefillData) {
            var options = {
                key: 'rzp_test_zC3sS3nzPNXddi', //Razorpay key ID
                amount: totalAmount * 100, // Amount in paisa
                currency: 'INR',
                name: 'Audio Booth',
                description: 'Payment for your order',
                order_id: orderId,
                handler: function (response) {
                    // Handle the payment success response
                    console.log('Payment response:', response);
                    if (response.razorpay_order_id) {

                        // Payment was successful
                        console.log('Payment successful!');
                        // Submit the form after successful payment
                        document.getElementById('checkoutForm').submit();
                    }

                },
                prefill: prefillData,
                theme: {
                    color: '#528FF0' // Customize the color theme
                }
            };

            // Add a failure callback
            options['modal.ondismiss'] = function () {
                console.log('Payment failed or modal closed');
                // Get the form data
                var formData = new FormData(document.getElementById('checkoutForm'));
                var formDataJSON = {};
                formData.forEach((value, key) => {
                    formDataJSON[key] = value;
                });


                formDataJSON.paymentSuccess = 'false';

                fetch('/cart/checkout/process', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formDataJSON)
                })
                    .then(response => {
                        // Handle response
                        console.log('Payment status updated to Pending');

                    })
                    .catch(error => {
                        console.error('Error updating payment status:', error);
                    });

                // Redirect the user to a failure page
                window.location.href = '/payment-failure';



            };

            var rzp = new Razorpay(options);
            rzp.open();
        }


        // Event listener for form submission
        document.getElementById('checkoutForm').addEventListener('submit', async function (event) {
            event.preventDefault(); // Prevent the default form submission
            var formData = new FormData(this); // Get form data
            var paymentMethod = formData.get('payMethod'); // Get selected payment method
            if (paymentMethod === 'Razorpay') {
                try {
                    // Retrieve total amount from form data
                    var totalAmount = formData.get('totalAmount');

                    // Fetch data from server to create Razorpay order
                    var response = await fetch('/create/orderId', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            totalAmount: totalAmount
                        })
                    });
                    var data = await response.json();

                    // Retrieve user information from form fields
                    var userName = formData.get('billing-name');
                    var userEmail = formData.get('billing-email-address');
                    var userPhone = formData.get('billing-phone');

                    // Populate prefill data
                    var prefillData = {
                        name: userName,
                        email: userEmail,
                        contact: userPhone
                    };

                    // Initiate Razorpay payment with order ID, total amount, and prefill data
                    initiateRazorpayPayment(data.orderId, totalAmount, prefillData);
                } catch (error) {
                    console.error('Error creating Razorpay order:', error);
                    // Handle error
                }
            } else {
                // For other payment methods, submit the form directly
                this.submit();
            }
        });

    </script>



</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

</html>